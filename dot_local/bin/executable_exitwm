#!/usr/bin/env bash

set -e -o pipefail

action="$(rofi -dmenu -match regex <<EOF
l: lock
c: close
s: sleep
h: hibernate
L: Logoff
S: Shutdown
R: Restart
EOF
)"

case "$action" in
  "l: lock")
    dm-tool switch-to-greeter
    ;;
  "c: close")
    dm-tool lock
    ;;
  "s: sleep")
    dm-tool switch-to-greeter || true
    systemctl suspend
    ;;
  "h: hibernate")
    dm-tool switch-to-greeter || true
    systemctl hibernate
    ;;
  "L: Logoff")
    "$@"
    ;;
  "S: Shutdown")
    systemctl poweroff
    ;;
  "R: Restart")
    systemctl reboot
    ;;
  *)
    exit 1
esac
